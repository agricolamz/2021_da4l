<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>10 Логистическая, порядковая и мультиномиальная регрессия | Анализ данных для лингвистов</title>
  <meta name="description" content="10 Логистическая, порядковая и мультиномиальная регрессия | Анализ данных для лингвистов" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="10 Логистическая, порядковая и мультиномиальная регрессия | Анализ данных для лингвистов" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="10 Логистическая, порядковая и мультиномиальная регрессия | Анализ данных для лингвистов" />
  
  
  

<meta name="author" content="Г. А. Мороз" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ограничения-на-применение-регрессии.html"/>
<link rel="next" href="ссылки-на-литературу.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Анализ данных для лингвистов</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> О курсе</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#домашние-задания"><i class="fa fa-check"></i><b>1.1</b> Домашние задания</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#используемые-пакеты"><i class="fa fa-check"></i><b>1.2</b> Используемые пакеты</a></li>
</ul></li>
<li class="part"><span><b>I Основы байесовской статистики</b></span></li>
<li class="chapter" data-level="2" data-path="распределения.html"><a href="распределения.html"><i class="fa fa-check"></i><b>2</b> Распределения</a>
<ul>
<li class="chapter" data-level="2.1" data-path="распределения.html"><a href="распределения.html#распределения-в-r"><i class="fa fa-check"></i><b>2.1</b> Распределения в R</a></li>
<li class="chapter" data-level="2.2" data-path="распределения.html"><a href="распределения.html#дискретные-переменные"><i class="fa fa-check"></i><b>2.2</b> Дискретные переменные</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="распределения.html"><a href="распределения.html#биномиальное-распределение"><i class="fa fa-check"></i><b>2.2.1</b> Биномиальное распределение</a></li>
<li class="chapter" data-level="2.2.2" data-path="распределения.html"><a href="распределения.html#геометрическое-распределение"><i class="fa fa-check"></i><b>2.2.2</b> Геометрическое распределение</a></li>
<li class="chapter" data-level="2.2.3" data-path="распределения.html"><a href="распределения.html#распределение-пуассона"><i class="fa fa-check"></i><b>2.2.3</b> Распределение Пуассона</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="распределения.html"><a href="распределения.html#числовые-переменные"><i class="fa fa-check"></i><b>2.3</b> Числовые переменные</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="распределения.html"><a href="распределения.html#нормальное-распределение"><i class="fa fa-check"></i><b>2.3.1</b> Нормальное распределение</a></li>
<li class="chapter" data-level="2.3.2" data-path="распределения.html"><a href="распределения.html#логнормальное-распределение"><i class="fa fa-check"></i><b>2.3.2</b> Логнормальное распределение</a></li>
<li class="chapter" data-level="2.3.3" data-path="распределения.html"><a href="распределения.html#что-еще-почитать-про-распределения"><i class="fa fa-check"></i><b>2.3.3</b> Что еще почитать про распределения?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="метод-максимального-правдоподобия.html"><a href="метод-максимального-правдоподобия.html"><i class="fa fa-check"></i><b>3</b> Метод максимального правдоподобия</a>
<ul>
<li class="chapter" data-level="3.1" data-path="метод-максимального-правдоподобия.html"><a href="метод-максимального-правдоподобия.html#оценка-вероятности"><i class="fa fa-check"></i><b>3.1</b> Оценка вероятности</a></li>
<li class="chapter" data-level="3.2" data-path="метод-максимального-правдоподобия.html"><a href="метод-максимального-правдоподобия.html#функция-правдоподобия"><i class="fa fa-check"></i><b>3.2</b> Функция правдоподобия</a></li>
<li class="chapter" data-level="3.3" data-path="метод-максимального-правдоподобия.html"><a href="метод-максимального-правдоподобия.html#пример-с-непрерывным-распределением"><i class="fa fa-check"></i><b>3.3</b> Пример с непрерывным распределением</a></li>
<li class="chapter" data-level="3.4" data-path="метод-максимального-правдоподобия.html"><a href="метод-максимального-правдоподобия.html#метод-максимального-правдоподобия-mle"><i class="fa fa-check"></i><b>3.4</b> Метод максимального правдоподобия (MLE)</a></li>
<li class="chapter" data-level="3.5" data-path="метод-максимального-правдоподобия.html"><a href="метод-максимального-правдоподобия.html#логорифм-функции-правдоподобия"><i class="fa fa-check"></i><b>3.5</b> Логорифм функции правдоподобия</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="модели-смеси-распределений.html"><a href="модели-смеси-распределений.html"><i class="fa fa-check"></i><b>4</b> Модели смеси распределений</a>
<ul>
<li class="chapter" data-level="4.1" data-path="модели-смеси-распределений.html"><a href="модели-смеси-распределений.html#cмеси-распределений"><i class="fa fa-check"></i><b>4.1</b> Cмеси распределений</a></li>
<li class="chapter" data-level="4.2" data-path="модели-смеси-распределений.html"><a href="модели-смеси-распределений.html#модели-смеси-распределений-1"><i class="fa fa-check"></i><b>4.2</b> Модели смеси распределений</a></li>
<li class="chapter" data-level="4.3" data-path="модели-смеси-распределений.html"><a href="модели-смеси-распределений.html#несколько-замечаний"><i class="fa fa-check"></i><b>4.3</b> Несколько замечаний</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="байесовский-статистический-вывод.html"><a href="байесовский-статистический-вывод.html"><i class="fa fa-check"></i><b>5</b> Байесовский статистический вывод</a>
<ul>
<li class="chapter" data-level="5.1" data-path="байесовский-статистический-вывод.html"><a href="байесовский-статистический-вывод.html#нотация"><i class="fa fa-check"></i><b>5.1</b> Нотация</a></li>
<li class="chapter" data-level="5.2" data-path="байесовский-статистический-вывод.html"><a href="байесовский-статистический-вывод.html#категориальный-пример"><i class="fa fa-check"></i><b>5.2</b> Категориальный пример</a></li>
<li class="chapter" data-level="5.3" data-path="байесовский-статистический-вывод.html"><a href="байесовский-статистический-вывод.html#разница-между-фриквентиским-и-байесовским-подходами"><i class="fa fa-check"></i><b>5.3</b> Разница между фриквентиским и байесовским подходами</a></li>
<li class="chapter" data-level="5.4" data-path="байесовский-статистический-вывод.html"><a href="байесовский-статистический-вывод.html#биномиальные-данные"><i class="fa fa-check"></i><b>5.4</b> Биномиальные данные</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="байесовский-статистический-вывод.html"><a href="байесовский-статистический-вывод.html#биномиальное-распределение-1"><i class="fa fa-check"></i><b>5.4.1</b> Биномиальное распределение</a></li>
<li class="chapter" data-level="5.4.2" data-path="байесовский-статистический-вывод.html"><a href="байесовский-статистический-вывод.html#бета-распределение"><i class="fa fa-check"></i><b>5.4.2</b> Бета распределение</a></li>
<li class="chapter" data-level="5.4.3" data-path="байесовский-статистический-вывод.html"><a href="байесовский-статистический-вывод.html#байесовский-апдейт-биномиальных-данных"><i class="fa fa-check"></i><b>5.4.3</b> Байесовский апдейт биномиальных данных</a></li>
<li class="chapter" data-level="5.4.4" data-path="байесовский-статистический-вывод.html"><a href="байесовский-статистический-вывод.html#байесовский-апдейт-биномиальных-данных-несколько-моделей"><i class="fa fa-check"></i><b>5.4.4</b> Байесовский апдейт биномиальных данных: несколько моделей</a></li>
<li class="chapter" data-level="5.4.5" data-path="байесовский-статистический-вывод.html"><a href="байесовский-статистический-вывод.html#что-почитать"><i class="fa fa-check"></i><b>5.4.5</b> Что почитать?</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="байесовский-статистический-вывод.html"><a href="байесовский-статистический-вывод.html#байесовский-апдейт-нормального-распределения"><i class="fa fa-check"></i><b>5.5</b> Байесовский апдейт нормального распределения</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="байесовский-статистический-вывод.html"><a href="байесовский-статистический-вывод.html#байесовский-апдейт-нормального-распределения-выбор-из-нескольких-моделей"><i class="fa fa-check"></i><b>5.5.1</b> Байесовский апдейт нормального распределения: выбор из нескольких моделей</a></li>
<li class="chapter" data-level="5.5.2" data-path="байесовский-статистический-вывод.html"><a href="байесовский-статистический-вывод.html#байесовский-апдейт-нормального-распределения-непрерывный-вариант"><i class="fa fa-check"></i><b>5.5.2</b> Байесовский апдейт нормального распределения: непрерывный вариант</a></li>
<li class="chapter" data-level="5.5.3" data-path="байесовский-статистический-вывод.html"><a href="байесовский-статистический-вывод.html#что-почитать-1"><i class="fa fa-check"></i><b>5.5.3</b> Что почитать?</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="байесовский-статистический-вывод.html"><a href="байесовский-статистический-вывод.html#другие-распределения"><i class="fa fa-check"></i><b>5.6</b> Другие распределения</a></li>
<li class="chapter" data-level="5.7" data-path="байесовский-статистический-вывод.html"><a href="байесовский-статистический-вывод.html#вопросы-к-апостериорному-распределению"><i class="fa fa-check"></i><b>5.7</b> Вопросы к апостериорному распределению</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="байесовский-доверительный-интервал.html"><a href="байесовский-доверительный-интервал.html"><i class="fa fa-check"></i><b>6</b> Байесовский доверительный интервал</a>
<ul>
<li class="chapter" data-level="6.1" data-path="байесовский-доверительный-интервал.html"><a href="байесовский-доверительный-интервал.html#фреквентисткий-доверительный-интервал"><i class="fa fa-check"></i><b>6.1</b> Фреквентисткий доверительный интервал</a></li>
<li class="chapter" data-level="6.2" data-path="байесовский-доверительный-интервал.html"><a href="байесовский-доверительный-интервал.html#байесовский-доверительный-интервал-1"><i class="fa fa-check"></i><b>6.2</b> Байесовский доверительный интервал</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="коэффициент-байеса.html"><a href="коэффициент-байеса.html"><i class="fa fa-check"></i><b>7</b> Коэффициент Байеса</a>
<ul>
<li class="chapter" data-level="7.1" data-path="коэффициент-байеса.html"><a href="коэффициент-байеса.html#формула-байеса-опять"><i class="fa fa-check"></i><b>7.1</b> Формула Байеса опять</a></li>
<li class="chapter" data-level="7.2" data-path="коэффициент-байеса.html"><a href="коэффициент-байеса.html#категориальные-данные"><i class="fa fa-check"></i><b>7.2</b> Категориальные данные</a></li>
<li class="chapter" data-level="7.3" data-path="коэффициент-байеса.html"><a href="коэффициент-байеса.html#интерпретация-коэфициента-байеса"><i class="fa fa-check"></i><b>7.3</b> <span>Интерпретация коэфициента Байеса</span></a></li>
<li class="chapter" data-level="7.4" data-path="коэффициент-байеса.html"><a href="коэффициент-байеса.html#биномиальные-данные-1"><i class="fa fa-check"></i><b>7.4</b> Биномиальные данные</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="эмпирическая-байесовская-оценка.html"><a href="эмпирическая-байесовская-оценка.html"><i class="fa fa-check"></i><b>8</b> Эмпирическая байесовская оценка</a></li>
<li class="part"><span><b>II Продвинутый регрессионный анализ</b></span></li>
<li class="chapter" data-level="9" data-path="ограничения-на-применение-регрессии.html"><a href="ограничения-на-применение-регрессии.html"><i class="fa fa-check"></i><b>9</b> Ограничения на применение регрессии</a>
<ul>
<li class="chapter" data-level="9.1" data-path="ограничения-на-применение-регрессии.html"><a href="ограничения-на-применение-регрессии.html#введение"><i class="fa fa-check"></i><b>9.1</b> Введение</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="ограничения-на-применение-регрессии.html"><a href="ограничения-на-применение-регрессии.html#библиотеки"><i class="fa fa-check"></i><b>9.1.1</b> Библиотеки</a></li>
<li class="chapter" data-level="9.1.2" data-path="ограничения-на-применение-регрессии.html"><a href="ограничения-на-применение-регрессии.html#lexical-decision-task-data"><i class="fa fa-check"></i><b>9.1.2</b> Lexical Decision Task data</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="ограничения-на-применение-регрессии.html"><a href="ограничения-на-применение-регрессии.html#нелинейность-взаимосвязи"><i class="fa fa-check"></i><b>9.2</b> Нелинейность взаимосвязи</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="ограничения-на-применение-регрессии.html"><a href="ограничения-на-применение-регрессии.html#логарифмирование"><i class="fa fa-check"></i><b>9.2.1</b> Логарифмирование</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="ограничения-на-применение-регрессии.html"><a href="ограничения-на-применение-регрессии.html#нормальность-распределение-остатков"><i class="fa fa-check"></i><b>9.3</b> Нормальность распределение остатков</a></li>
<li class="chapter" data-level="9.4" data-path="ограничения-на-применение-регрессии.html"><a href="ограничения-на-применение-регрессии.html#гетероскидастичность"><i class="fa fa-check"></i><b>9.4</b> Гетероскидастичность</a></li>
<li class="chapter" data-level="9.5" data-path="ограничения-на-применение-регрессии.html"><a href="ограничения-на-применение-регрессии.html#мультиколлинеарность"><i class="fa fa-check"></i><b>9.5</b> Мультиколлинеарность</a></li>
<li class="chapter" data-level="9.6" data-path="ограничения-на-применение-регрессии.html"><a href="ограничения-на-применение-регрессии.html#независимость-наблюдений"><i class="fa fa-check"></i><b>9.6</b> Независимость наблюдений</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="ограничения-на-применение-регрессии.html"><a href="ограничения-на-применение-регрессии.html#линейная-модель-со-смешанными-эффектами"><i class="fa fa-check"></i><b>9.6.1</b> Линейная модель со смешанными эффектами</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="логистическая-порядковая-и-мультиномиальная-регрессия.html"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html"><i class="fa fa-check"></i><b>10</b> Логистическая, порядковая и мультиномиальная регрессия</a>
<ul>
<li class="chapter" data-level="10.1" data-path="логистическая-порядковая-и-мультиномиальная-регрессия.html"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#логистическая-регрессия"><i class="fa fa-check"></i><b>10.1</b> Логистическая регрессия</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="логистическая-порядковая-и-мультиномиальная-регрессия.html"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#теория"><i class="fa fa-check"></i><b>10.1.1</b> Теория</a></li>
<li class="chapter" data-level="10.1.2" data-path="логистическая-порядковая-и-мультиномиальная-регрессия.html"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#практика"><i class="fa fa-check"></i><b>10.1.2</b> Практика</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="логистическая-порядковая-и-мультиномиальная-регрессия.html"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#порядковая-логистическая-регрессия"><i class="fa fa-check"></i><b>10.2</b> Порядковая логистическая регрессия</a></li>
<li class="chapter" data-level="10.3" data-path="логистическая-порядковая-и-мультиномиальная-регрессия.html"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#мультиномиальная-регрессия"><i class="fa fa-check"></i><b>10.3</b> Мультиномиальная регрессия</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ссылки-на-литературу.html"><a href="ссылки-на-литературу.html"><i class="fa fa-check"></i>Ссылки на литературу</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Анализ данных для лингвистов</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="логистическая-порядковая-и-мультиномиальная-регрессия" class="section level1" number="10">
<h1><span class="header-section-number">10</span> Логистическая, порядковая и мультиномиальная регрессия</h1>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<p>Логистическая (logit, logistic) и мультиномиальная (multinomial) регрессия применяются в случаях, когда зависимая переменная является категориальной:</p>
<ul>
<li>с двумя значениями (логистическая регрессия)</li>
<li>с более чем двумя значениями, упорядоченными в иерархию (порядковая регрессия)</li>
<li>с более чем двумя значениями (мультиномиальная регрессия)</li>
</ul>
<div id="логистическая-регрессия" class="section level2" number="10.1">
<h2><span class="header-section-number">10.1</span> Логистическая регрессия</h2>
<div id="теория" class="section level3" number="10.1.1">
<h3><span class="header-section-number">10.1.1</span> Теория</h3>
<p>Мы хотим чего-то такого:
<span class="math display">\[\underbrace{y}_{[-\infty, +\infty]}=\underbrace{\mbox{β}_0+\mbox{β}_1\cdot x_1+\mbox{β}_2\cdot x_2 + \dots +\mbox{β}_k\cdot x_k +\mbox{ε}_i}_{[-\infty, +\infty]}\]</span>
Вероятность — отношение количества успехов к общему числу событий:
<span class="math display">\[p = \frac{\mbox{# успехов}}{\mbox{# неудач} + \mbox{# успехов}}, p \in [0, 1]\]</span>
Шансы — отношение количества успехов к количеству неудач:
<span class="math display">\[odds = \frac{p}{1-p} = \frac{p\mbox{(успеха)}}{p\mbox{(неудачи)}}, odds \in [0, +\infty]\]</span>
Натуральный логарифм шансов:
<span class="math display">\[\log(odds) \in [-\infty, +\infty]\]</span></p>
<p>Но, что нам говорит логарифм шансов? Как нам его интерпретировать?</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">n =</span> <span class="dv">10</span>,</span>
<span id="cb158-2"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb158-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">success =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>,</span>
<span id="cb158-3"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb158-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">failure =</span> n <span class="sc">-</span> success,</span>
<span id="cb158-4"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb158-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">prob.1 =</span> success<span class="sc">/</span>(success<span class="sc">+</span>failure),</span>
<span id="cb158-5"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb158-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">odds =</span> success<span class="sc">/</span>failure,</span>
<span id="cb158-6"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb158-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">log_odds =</span> <span class="fu">log</span>(odds),</span>
<span id="cb158-7"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb158-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">prob.2 =</span> <span class="fu">exp</span>(log_odds)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(log_odds)))</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["n"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["success"],"name":[2],"type":["int"],"align":["right"]},{"label":["failure"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["prob.1"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["odds"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["log_odds"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["prob.2"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"10","2":"1","3":"9","4":"0.1","5":"0.1111111","6":"-2.1972246","7":"0.1"},{"1":"10","2":"2","3":"8","4":"0.2","5":"0.2500000","6":"-1.3862944","7":"0.2"},{"1":"10","2":"3","3":"7","4":"0.3","5":"0.4285714","6":"-0.8472979","7":"0.3"},{"1":"10","2":"4","3":"6","4":"0.4","5":"0.6666667","6":"-0.4054651","7":"0.4"},{"1":"10","2":"5","3":"5","4":"0.5","5":"1.0000000","6":"0.0000000","7":"0.5"},{"1":"10","2":"6","3":"4","4":"0.6","5":"1.5000000","6":"0.4054651","7":"0.6"},{"1":"10","2":"7","3":"3","4":"0.7","5":"2.3333333","6":"0.8472979","7":"0.7"},{"1":"10","2":"8","3":"2","4":"0.8","5":"4.0000000","6":"1.3862944","7":"0.8"},{"1":"10","2":"9","3":"1","4":"0.9","5":"9.0000000","6":"2.1972246","7":"0.9"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Как связаны вероятность и логарифм шансов:
<span class="math display">\[\log(odds) = \log\left(\frac{p}{1-p}\right)\]</span>
<span class="math display">\[p = \frac{\exp(\log(odds))}{1+\exp(\log(odds))}\]</span></p>
<div class="rmdtask">
<p>
Логарифм шансов равен 0.25. Посчитайте вероятность успеха:
</p>
</div>
<form name="form_46950" onsubmit="return validate_form_46950()" method="post">
<input type="text" name="answer_46950"><br><input type="submit" value="check">
</form>
<p id="result_46950">
</p>
<script> function validate_form_46950() {var x, text; var x = document.forms["form_46950"]["answer_46950"].value;if (x == "0.562176500885798"){text = 'Correct';} else {text = 'I have a different answer';} document.getElementById('result_46950').innerHTML = text; return false;} </script>
<p>Как связаны вероятность и логарифм шансов:</p>
<p><img src="da4l_files/figure-html/unnamed-chunk-157-1.png" width="672" /><img src="da4l_files/figure-html/unnamed-chunk-157-2.png" width="672" /><img src="da4l_files/figure-html/unnamed-chunk-157-3.png" width="672" /><img src="da4l_files/figure-html/unnamed-chunk-157-4.png" width="672" /></p>
</div>
<div id="практика" class="section level3" number="10.1.2">
<h3><span class="header-section-number">10.1.2</span> Практика</h3>
<p>В датасет собрано 19 языков, со следующими переменными:</p>
<ul>
<li><code>language</code> — переменная, содержащая язык</li>
<li><code>tone</code> — бинарная переменная, обозначающая наличие тонов</li>
<li><code>long_vowels</code> — бинарная переменная, обозначающая наличие долгих гласных</li>
<li><code>stress</code> — бинарная переменная, обозначающая наличие ударения</li>
<li><code>ejectives</code> — бинарная переменная, обозначающая наличие абруптивных</li>
<li><code>consonants</code> — переменная, содержащая информацию о количестве согласных</li>
<li><code>vowels</code> — переменная, содержащая информацию о количестве гласных</li>
</ul>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb159-1" aria-hidden="true" tabindex="-1"></a>phonological_profiles <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/agricolamz/2021_da4l/master/data/phonological_profiles.csv&quot;</span>)</span>
<span id="cb159-2"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(phonological_profiles)</span></code></pre></div>
<pre><code>Rows: 19
Columns: 8
$ language    &lt;chr&gt; &quot;Turkish&quot;, &quot;Korean&quot;, &quot;Tiwi&quot;, &quot;Liberia Kpelle&quot;, &quot;Tulu&quot;, &quot;M…
$ tone        &lt;lgl&gt; FALSE, FALSE, FALSE, TRUE, FALSE, FALSE, TRUE, FALSE, TRU…
$ long_vowels &lt;lgl&gt; TRUE, FALSE, FALSE, FALSE, TRUE, FALSE, TRUE, FALSE, TRUE…
$ stress      &lt;lgl&gt; TRUE, TRUE, TRUE, FALSE, FALSE, TRUE, FALSE, TRUE, TRUE, …
$ ejectives   &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, F…
$ consonants  &lt;dbl&gt; 25, 21, 22, 22, 24, 20, 22, 24, 15, 18, 17, 8, 26, 28, 30…
$ vowels      &lt;dbl&gt; 8, 11, 4, 12, 13, 6, 20, 12, 5, 11, 8, 5, 14, 6, 7, 7, 5,…
$ area        &lt;chr&gt; &quot;Eurasia&quot;, &quot;Eurasia&quot;, &quot;Australia&quot;, &quot;Africa&quot;, &quot;Eurasia&quot;, &quot;…</code></pre>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb161-2"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb161-2" aria-hidden="true" tabindex="-1"></a>phonological_profiles <span class="sc">%&gt;%</span> </span>
<span id="cb161-3"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb161-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(ejectives, consonants))<span class="sc">+</span></span>
<span id="cb161-4"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb161-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> ejectives), <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">outlier.alpha =</span> <span class="dv">0</span>)<span class="sc">+</span> </span>
<span id="cb161-5"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb161-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># по умолчанию боксплот рисует выбросы, outlier.alpha = 0 -- это отключает</span></span>
<span id="cb161-6"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb161-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">size =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="da4l_files/figure-html/unnamed-chunk-158-1.png" width="672" /></p>
<div id="почему-не-линейную-регрессию" class="section level4" number="10.1.2.1">
<h4><span class="header-section-number">10.1.2.1</span> Почему не линейную регрессию?</h4>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb162-1" aria-hidden="true" tabindex="-1"></a>lm_0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">as.double</span>(ejectives)<span class="sc">~</span><span class="dv">1</span>, <span class="at">data =</span> phonological_profiles)</span>
<span id="cb162-2"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb162-2" aria-hidden="true" tabindex="-1"></a>lm_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">as.double</span>(ejectives)<span class="sc">~</span>consonants, <span class="at">data =</span> phonological_profiles)</span>
<span id="cb162-3"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb162-3" aria-hidden="true" tabindex="-1"></a>lm_0</span></code></pre></div>
<pre><code>
Call:
lm(formula = as.double(ejectives) ~ 1, data = phonological_profiles)

Coefficients:
(Intercept)  
     0.3158  </code></pre>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb164-1" aria-hidden="true" tabindex="-1"></a>lm_1</span></code></pre></div>
<pre><code>
Call:
lm(formula = as.double(ejectives) ~ consonants, data = phonological_profiles)

Coefficients:
(Intercept)   consonants  
    -0.5389       0.0353  </code></pre>
<p>Первая модель:
<span class="math display">\[ejectives = 0.3158 \times consonants\]</span>
Вторая модель:
<span class="math display">\[ejectives = -0.5389 + 0.0353 \times consonants\]</span></p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb166-1" aria-hidden="true" tabindex="-1"></a>phonological_profiles <span class="sc">%&gt;%</span> </span>
<span id="cb166-2"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb166-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(consonants, <span class="fu">as.double</span>(ejectives)))<span class="sc">+</span></span>
<span id="cb166-3"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb166-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb166-4"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb166-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>)<span class="sc">+</span></span>
<span id="cb166-5"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb166-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb166-6"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb166-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;ejectives (yes = 2, no = 1)&quot;</span>)</span></code></pre></div>
<p><img src="da4l_files/figure-html/unnamed-chunk-160-1.png" width="672" /></p>
</div>
<div id="модель-без-предиктора" class="section level4" number="10.1.2.2">
<h4><span class="header-section-number">10.1.2.2</span> Модель без предиктора</h4>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb167-1" aria-hidden="true" tabindex="-1"></a>logit_0 <span class="ot">&lt;-</span> <span class="fu">glm</span>(ejectives<span class="sc">~</span><span class="dv">1</span>, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>, <span class="at">data =</span> phonological_profiles)</span>
<span id="cb167-2"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logit_0)</span></code></pre></div>
<pre><code>
Call:
glm(formula = ejectives ~ 1, family = &quot;binomial&quot;, data = phonological_profiles)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.8712  -0.8712  -0.8712   1.5183   1.5183  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)  -0.7732     0.4935  -1.567    0.117

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 23.699  on 18  degrees of freedom
Residual deviance: 23.699  on 18  degrees of freedom
AIC: 25.699

Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb169-1" aria-hidden="true" tabindex="-1"></a>logit_0<span class="sc">$</span>coefficients</span></code></pre></div>
<pre><code>(Intercept) 
 -0.7731899 </code></pre>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(phonological_profiles<span class="sc">$</span>ejectives)</span></code></pre></div>
<pre><code>
FALSE  TRUE 
   13     6 </code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="dv">6</span><span class="sc">/</span><span class="dv">13</span>) <span class="co"># β0</span></span></code></pre></div>
<pre><code>[1] -0.7731899</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span><span class="sc">/</span>(<span class="dv">13</span><span class="sc">+</span><span class="dv">6</span>) <span class="co"># p</span></span></code></pre></div>
<pre><code>[1] 0.3157895</code></pre>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">log</span>(<span class="dv">6</span><span class="sc">/</span><span class="dv">13</span>))<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="fu">log</span>(<span class="dv">6</span><span class="sc">/</span><span class="dv">13</span>))) <span class="co"># p</span></span></code></pre></div>
<pre><code>[1] 0.3157895</code></pre>
<div class="rmdtask">
<p>
Какой коэфициент логистической регрессии, мы получим, запустив модель, предсказывающую количество <em>s</em>-генитивов, если наши данные состоят из 620 <em>s</em>-генитивов из 699 генетивных контекстов?
</p>
<p>
Ответ округлите до трех и меньше знаков после запятой.
</p>
</div>
<form name="form_28559" onsubmit="return validate_form_28559()" method="post">
<input type="text" name="answer_28559"><br><input type="submit" value="check">
</form>
<p id="result_28559">
</p>
<script> function validate_form_28559() {var x, text; var x = document.forms["form_28559"]["answer_28559"].value;if (x == "2.06"){text = 'Correct';} else {text = 'I have a different answer';} document.getElementById('result_28559').innerHTML = text; return false;} </script>
</div>
<div id="модель-c-одним-числовым-предиктором" class="section level4" number="10.1.2.3">
<h4><span class="header-section-number">10.1.2.3</span> Модель c одним числовым предиктором</h4>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb179-1" aria-hidden="true" tabindex="-1"></a>logit_1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(ejectives<span class="sc">~</span>consonants, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>, <span class="at">data =</span> phonological_profiles)</span>
<span id="cb179-2"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb179-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logit_1)</span></code></pre></div>
<pre><code>
Call:
glm(formula = ejectives ~ consonants, family = &quot;binomial&quot;, data = phonological_profiles)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.08779  -0.49331  -0.20265   0.02254   2.45384  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept) -12.1123     6.1266  -1.977   0.0480 *
consonants    0.4576     0.2436   1.878   0.0603 .
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 23.699  on 18  degrees of freedom
Residual deviance: 12.192  on 17  degrees of freedom
AIC: 16.192

Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb181-1" aria-hidden="true" tabindex="-1"></a>logit_1<span class="sc">$</span>coefficients</span></code></pre></div>
<pre><code>(Intercept)  consonants 
-12.1123347   0.4576095 </code></pre>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb183-1" aria-hidden="true" tabindex="-1"></a>phonological_profiles <span class="sc">%&gt;%</span> </span>
<span id="cb183-2"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb183-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ejectives =</span> <span class="fu">as.double</span>(ejectives)) <span class="sc">%&gt;%</span> </span>
<span id="cb183-3"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb183-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(consonants, ejectives)) <span class="sc">+</span></span>
<span id="cb183-4"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb183-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;glm&quot;</span>, </span>
<span id="cb183-5"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb183-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>),</span>
<span id="cb183-6"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb183-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb183-7"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb183-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="da4l_files/figure-html/unnamed-chunk-164-1.png" width="672" /></p>
<p>Какова вероятность, что в языке с 29 согласными есть абруптивные?</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb184-1" aria-hidden="true" tabindex="-1"></a>logit_1<span class="sc">$</span>coefficients</span></code></pre></div>
<pre><code>(Intercept)  consonants 
-12.1123347   0.4576095 </code></pre>
<p><span class="math display">\[\log\left({\frac{p}{1-p}}\right)_i=\beta_0+\beta_1\times consinants_i + \epsilon_i\]</span>
<span class="math display">\[\log\left({\frac{p}{1-p}}\right)=-12.1123347 + 0.4576095 \times 29 = 1.158341\]</span>
<span class="math display">\[p = \frac{e^{1.158341}}{1+e^{1.158341}} = 0.7610311\]</span></p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="co"># log(odds)</span></span>
<span id="cb186-2"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb186-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logit_1, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">consonants =</span> <span class="dv">29</span>))</span></code></pre></div>
<pre><code>       1 
1.158341 </code></pre>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p</span></span>
<span id="cb188-2"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb188-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logit_1, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">consonants =</span> <span class="dv">29</span>), <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<pre><code>        1 
0.7610312 </code></pre>
<div class="rmdtask">
<p>
Какой логорифм шансов предсказывает наша модель для языка с 25 согласными (6 знаков после запятой)?
</p>
</div>
<form name="form_88261" onsubmit="return validate_form_88261()" method="post">
<input type="text" name="answer_88261"><br><input type="submit" value="check">
</form>
<p id="result_88261">
</p>
<script> function validate_form_88261() {var x, text; var x = document.forms["form_88261"]["answer_88261"].value;if (x == "-0.672097"){text = 'Correct';} else {text = 'I have a different answer';} document.getElementById('result_88261').innerHTML = text; return false;} </script>
<div class="rmdtask">
<p>
Какую вероятность предсказывает наша модель для языка с 25 согласными (6 знаков после запятой)?
</p>
</div>
<form name="form_11224" onsubmit="return validate_form_11224()" method="post">
<input type="text" name="answer_11224"><br><input type="submit" value="check">
</form>
<p id="result_11224">
</p>
<script> function validate_form_11224() {var x, text; var x = document.forms["form_11224"]["answer_11224"].value;if (x == "0.338028"){text = 'Correct';} else {text = 'I have a different answer';} document.getElementById('result_11224').innerHTML = text; return false;} </script>
</div>
<div id="модель-c-одним-категориальным-предиктором" class="section level4" number="10.1.2.4">
<h4><span class="header-section-number">10.1.2.4</span> Модель c одним категориальным предиктором</h4>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb190-1" aria-hidden="true" tabindex="-1"></a>logit_2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(ejectives<span class="sc">~</span>area, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>, <span class="at">data =</span> phonological_profiles)</span>
<span id="cb190-2"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb190-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logit_2)</span></code></pre></div>
<pre><code>
Call:
glm(formula = ejectives ~ area, family = &quot;binomial&quot;, data = phonological_profiles)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.66511  -0.55525  -0.00013   0.75853   1.97277  

Coefficients:
                                  Estimate               Std. Error z value
(Intercept)          0.0000000000000001507    0.9999999999999996669   0.000
areaAustralia      -18.5660685098632356471 6522.6386791216082201572  -0.003
areaEurasia         -1.7917594692280549573    1.4719601443879741787  -1.217
areaNorth America    1.0986122886681095601    1.5275252316519465356   0.719
areaPapunesia      -18.5660685098631290657 6522.6386791215281846235  -0.003
areaSouth America  -18.5660685098637543433 4612.2020954414911102504  -0.004
                  Pr(&gt;|z|)
(Intercept)          1.000
areaAustralia        0.998
areaEurasia          0.224
areaNorth America    0.472
areaPapunesia        0.998
areaSouth America    0.997

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 23.699  on 18  degrees of freedom
Residual deviance: 15.785  on 13  degrees of freedom
AIC: 27.785

Number of Fisher Scoring iterations: 17</code></pre>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb192-1" aria-hidden="true" tabindex="-1"></a>logit_2<span class="sc">$</span>coefficients</span></code></pre></div>
<pre><code>             (Intercept)            areaAustralia              areaEurasia 
  0.00000000000000015067 -18.56606850986323564712  -1.79175946922805495731 
       areaNorth America            areaPapunesia        areaSouth America 
  1.09861228866810956006 -18.56606850986312906571 -18.56606850986375434331 </code></pre>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(phonological_profiles<span class="sc">$</span>ejectives, phonological_profiles<span class="sc">$</span>area)</span></code></pre></div>
<pre><code>       
        Africa Australia Eurasia North America Papunesia South America
  FALSE      2         1       6             1         1             2
  TRUE       2         0       1             3         0             0</code></pre>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>) <span class="co"># Eurasia</span></span></code></pre></div>
<pre><code>[1] -1.791759</code></pre>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">1</span>) <span class="co"># North America</span></span></code></pre></div>
<pre><code>[1] 1.098612</code></pre>
</div>
<div id="множественная-регрессия" class="section level4" number="10.1.2.5">
<h4><span class="header-section-number">10.1.2.5</span> Множественная регрессия</h4>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb200-1" aria-hidden="true" tabindex="-1"></a>logit_3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(ejectives<span class="sc">~</span>consonants<span class="sc">+</span>area, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>, <span class="at">data =</span> phonological_profiles)</span>
<span id="cb200-2"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logit_3)</span></code></pre></div>
<pre><code>
Call:
glm(formula = ejectives ~ consonants + area, family = &quot;binomial&quot;, 
    data = phonological_profiles)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.54011  -0.18623  -0.00012   0.00023   1.53307  

Coefficients:
                    Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)         -21.1760    15.1089  -1.402    0.161
consonants            0.8137     0.5653   1.439    0.150
areaAustralia       -16.2910 10754.0138  -0.002    0.999
areaEurasia          -1.2069     3.9399  -0.306    0.759
areaNorth America     4.0966     4.8563   0.844    0.399
areaPapunesia        -4.8995 10754.0184   0.000    1.000
areaSouth America   -17.1162  7065.6839  -0.002    0.998

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 23.6989  on 18  degrees of freedom
Residual deviance:  6.7901  on 12  degrees of freedom
AIC: 20.79

Number of Fisher Scoring iterations: 18</code></pre>
</div>
<div id="cравнение-моделей" class="section level4" number="10.1.2.6">
<h4><span class="header-section-number">10.1.2.6</span> Cравнение моделей</h4>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(logit_0, logit_1, logit_2, logit_3)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"25.69888","_rn_":"logit_0"},{"1":"2","2":"16.19167","_rn_":"logit_1"},{"1":"6","2":"27.78549","_rn_":"logit_2"},{"1":"7","2":"20.79005","_rn_":"logit_3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(logit_0, logit_1, logit_2, logit_3)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"26.64332","_rn_":"logit_0"},{"1":"2","2":"18.08055","_rn_":"logit_1"},{"1":"6","2":"33.45212","_rn_":"logit_2"},{"1":"7","2":"27.40113","_rn_":"logit_3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="rmdtask">
<p>
Выберите наилучшую модель согласно AIC и BIC:
</p>
</div>
<form name="form_33713" onsubmit="return validate_form_33713()" method="post">
<input type="radio" name="answer_33713" id="33713_1" value="logit_0"><label for="1">logit_0</label> <input type="radio" name="answer_33713" id="33713_2" value="logit_1"><label for="2">logit_1</label> <input type="radio" name="answer_33713" id="33713_3" value="logit_2"><label for="3">logit_2</label> <input type="radio" name="answer_33713" id="33713_4" value="logit_3"><label for="4">logit_3</label> <br><input type="submit" value="check">
</form>
<p id="result_33713">
</p>
<script> function validate_form_33713() {var x, text; var x = document.forms["form_33713"]["answer_33713"].value;if (x == "logit_1"){text = 'Correct';} else {text = 'I have a different answer';} document.getElementById('result_33713').innerHTML = text; return false;} </script>
<p>Для того, чтобы интерпретировать коэффициенты нужно проделать трансформацию:</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb204-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">exp</span>(logit_1<span class="sc">$</span>coefficients)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span></span></code></pre></div>
<pre><code>(Intercept)  consonants 
  -99.99945    58.02918 </code></pre>
<p>Перед нами процентное изменние шансов при увеличении независимой переменной на 1.</p>
<p>Было предложено много аналогов R<span class="math inline">\(^2\)</span>, например, McFadden’s R squared:</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb206-1" aria-hidden="true" tabindex="-1"></a>pscl<span class="sc">::</span><span class="fu">pR2</span>(logit_1)</span></code></pre></div>
<pre><code>fitting null model for pseudo-r2</code></pre>
<pre><code>        llh     llhNull          G2    McFadden        r2ML        r2CU 
 -6.0958355 -11.8494421  11.5072132   0.4855593   0.4542765   0.6373812 </code></pre>
<div class="rmdtask">
<p>
Проанализируйте в датасете с языками связь количества сегментов и наличия ударения. Постройте регрессию, визуализируйте связь. Какой вывод вы можете сделать?
</p>
</div>
</div>
</div>
</div>
<div id="порядковая-логистическая-регрессия" class="section level2" number="10.2">
<h2><span class="header-section-number">10.2</span> Порядковая логистическая регрессия</h2>
<p>Данные взяты из <a href="https://goo.gl/GC4RjQ">исследования [Endresen, Janda 2015]</a>, посвященное исследованию маргинальных глаголов изменения состояния в русском языке. Испытуемые (70 школьников, 51 взрослый) оценивали по <a href="https://goo.gl/R4gHiq">шкале Ликерта (1…5)</a> приемлемость глаголов с приставками <em>о-</em> и <em>у-</em>:</p>
<ul>
<li>широко используемуе в СРЛЯ (<em>освежить</em>, <em>уточнить</em>)</li>
<li>встретившие всего несколько раз в корпусе (<em>оржавить</em>, <em>увкуснить</em>)</li>
<li>искусственные слова (<em>ономить</em>, <em>укампить</em>)</li>
</ul>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb209-1" aria-hidden="true" tabindex="-1"></a>marginal_verbs <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/agricolamz/2021_da4l/master/data/marginal_verbs.csv&quot;</span>)</span>
<span id="cb209-2"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(marginal_verbs)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Gender"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Age"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["AgeGroup"],"name":[3],"type":["chr"],"align":["left"]},{"label":["Education"],"name":[4],"type":["chr"],"align":["left"]},{"label":["City"],"name":[5],"type":["chr"],"align":["left"]},{"label":["SubjectCode"],"name":[6],"type":["chr"],"align":["left"]},{"label":["Score"],"name":[7],"type":["chr"],"align":["left"]},{"label":["GivenScore"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["Stimulus"],"name":[9],"type":["chr"],"align":["left"]},{"label":["Prefix"],"name":[10],"type":["chr"],"align":["left"]},{"label":["WordType"],"name":[11],"type":["chr"],"align":["left"]},{"label":["CorpusFrequency"],"name":[12],"type":["dbl"],"align":["right"]}],"data":[{"1":"female","2":"16","3":"child","4":"school","5":"Izhevsk","6":"AA","7":"A","8":"5","9":"utochnit","10":"u","11":"standard","12":"2860"},{"1":"female","2":"16","3":"child","4":"school","5":"Izhevsk","6":"AA","7":"A","8":"5","9":"ozhestochit","10":"o","11":"standard","12":"686"},{"1":"female","2":"16","3":"child","4":"school","5":"Izhevsk","6":"AA","7":"E","8":"1","9":"ovneshnit","10":"o","11":"marginal","12":"4"},{"1":"female","2":"16","3":"child","4":"school","5":"Izhevsk","6":"AA","7":"E","8":"1","9":"oblusit","10":"o","11":"nonce","12":"0"},{"1":"female","2":"16","3":"child","4":"school","5":"Izhevsk","6":"AA","7":"A","8":"5","9":"osvezhit","10":"o","11":"standard","12":"280"},{"1":"female","2":"16","3":"child","4":"school","5":"Izhevsk","6":"AA","7":"A","8":"5","9":"oschastlivit","10":"o","11":"standard","12":"343"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Переменные в датасете:</p>
<ul>
<li>Gender</li>
<li>Age</li>
<li>AgeGroup — взрослые или школьники</li>
<li>Education</li>
<li>City</li>
<li>SubjectCode — код испытуемого</li>
<li>Score — оценка, поставленная испытуемым (A — самая высокая, E — самая низкая)</li>
<li>GivenScore — оценка, поставленная испытуемым (5 — самая высокая, 1 — самая низкая)</li>
<li>Stimulus</li>
<li>Prefix</li>
<li>WordType — тип слова: частотное, редкое, искусственное</li>
<li>CorpusFrequency — частотность в корпусе</li>
</ul>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb210-1" aria-hidden="true" tabindex="-1"></a>marginal_verbs<span class="sc">$</span>Score <span class="ot">&lt;-</span> <span class="fu">factor</span>(marginal_verbs<span class="sc">$</span>Score)</span>
<span id="cb210-2"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb210-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(marginal_verbs<span class="sc">$</span>Score)</span></code></pre></div>
<pre><code>[1] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot; &quot;E&quot;</code></pre>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb212-1" aria-hidden="true" tabindex="-1"></a>ordinal <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">polr</span>(Score<span class="sc">~</span>Prefix<span class="sc">+</span>WordType<span class="sc">+</span>CorpusFrequency, <span class="at">data =</span> marginal_verbs)</span>
<span id="cb212-2"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb212-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ordinal)</span></code></pre></div>
<pre><code>Call:
MASS::polr(formula = Score ~ Prefix + WordType + CorpusFrequency, 
    data = marginal_verbs)

Coefficients:
                     Value Std. Error t value
Prefixu           0.136619 0.05286365   2.584
WordTypenonce     1.340603 0.05692826  23.549
WordTypestandard -4.655327 0.12510542 -37.211
CorpusFrequency  -0.001015 0.00007879 -12.876

Intercepts:
    Value    Std. Error t value 
A|B  -2.6275   0.0753   -34.8784
B|C  -1.4531   0.0552   -26.3246
C|D  -0.2340   0.0479    -4.8853
D|E   0.7324   0.0492    14.8986

Residual Deviance: 13138.47 
AIC: 13154.47 </code></pre>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb214-1" aria-hidden="true" tabindex="-1"></a>ordinal<span class="sc">$</span>coefficients</span></code></pre></div>
<pre><code>         Prefixu    WordTypenonce WordTypestandard  CorpusFrequency 
     0.136619412      1.340602696     -4.655327418     -0.001014583 </code></pre>
<p>Как и раньше, можно преобразовать коэффициенты:</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb216-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">exp</span>(ordinal<span class="sc">$</span>coefficients)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span></span></code></pre></div>
<pre><code>         Prefixu    WordTypenonce WordTypestandard  CorpusFrequency 
      14.6391763      282.1345921      -99.0489201       -0.1014068 </code></pre>
<p><span class="math display">\[\log(\frac{p(A)}{p(B|C|D|E)}) = -2.6275 + 0.136619412 \times Prefixu +\]</span>
<span class="math display">\[+ 1.340602696 \times WordTypenonce -\]</span><br />
<span class="math display">\[-4.655327418 \times WordTypestandard - \]</span>
<span class="math display">\[ - 0.001014583\times CorpusFrequency\]</span>
<span class="math display">\[\log(\frac{p(A|B)}{p(C|D|E)}) = -1.4531 + 0.136619412 \times Prefixu + \]</span>
<span class="math display">\[ + 1.340602696 \times WordTypenonce-\]</span>
<span class="math display">\[-4.655327418 \times WordTypestandard -\]</span>
<span class="math display">\[ -0.001014583\times CorpusFrequency\]</span>
<span class="math display">\[\log(\frac{p(A|B|C)}{p(D|E)}) = -0.2340 + 0.136619412 \times Prefixu + \]</span>
<span class="math display">\[ + 1.340602696 \times WordTypenonce-\]</span>
<span class="math display">\[-4.655327418 \times WordTypestandard - \]</span>
<span class="math display">\[-0.001014583\times CorpusFrequency\]</span></p>
<p><span class="math display">\[\log(\frac{p(A|B|C|D)}{p(E)}) = 0.7324 + 0.136619412 \times Prefixu +\]</span>
<span class="math display">\[ + 1.340602696 \times WordTypenonce-\]</span>
<span class="math display">\[-4.655327418 \times WordTypestandard -\]</span>
<span class="math display">\[=0.001014583\times CorpusFrequency\]</span></p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">predict</span>(ordinal))</span></code></pre></div>
<pre><code>[1] A A E E A A
Levels: A B C D E</code></pre>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">predict</span>(ordinal, <span class="at">type =</span> <span class="st">&quot;probs&quot;</span>))</span></code></pre></div>
<pre><code>           A           B           C            D            E
1 0.99178000 0.005665533 0.001798242 0.0004683707 0.0002878525
2 0.93841926 0.041706786 0.013917668 0.0036817261 0.0022745617
3 0.06764594 0.122509282 0.252611927 0.2334448870 0.3237879649
4 0.01855865 0.039108932 0.113894002 0.1808984667 0.6475399508
5 0.90986002 0.060436871 0.020738032 0.0055351143 0.0034299624
6 0.91496678 0.057117954 0.019500629 0.0051963745 0.0032182669</code></pre>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb222-1" aria-hidden="true" tabindex="-1"></a>marginal_verbs <span class="sc">%&gt;%</span></span>
<span id="cb222-2"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb222-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">as_tibble</span>(<span class="fu">predict</span>(ordinal, <span class="at">type =</span> <span class="st">&quot;probs&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb222-3"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb222-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(score, predictions, A<span class="sc">:</span>E) <span class="sc">%&gt;%</span> </span>
<span id="cb222-4"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb222-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> score, <span class="at">y =</span> predictions, <span class="at">fill =</span> score)) <span class="sc">+</span></span>
<span id="cb222-5"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb222-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>)<span class="sc">+</span></span>
<span id="cb222-6"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb222-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Prefix<span class="sc">~</span>WordType)</span></code></pre></div>
<p><img src="da4l_files/figure-html/unnamed-chunk-183-1.png" width="672" /></p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb223-2"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb223-2" aria-hidden="true" tabindex="-1"></a>ordinal <span class="sc">%&gt;%</span> </span>
<span id="cb223-3"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb223-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggpredict</span>(<span class="at">terms =</span> <span class="fu">c</span>(<span class="st">&quot;Prefix&quot;</span>, <span class="st">&quot;WordType&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb223-4"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb223-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code></pre></div>
<p><img src="da4l_files/figure-html/unnamed-chunk-184-1.png" width="672" /></p>
</div>
<div id="мультиномиальная-регрессия" class="section level2" number="10.3">
<h2><span class="header-section-number">10.3</span> Мультиномиальная регрессия</h2>
<p>В этом датасете представлены три нанайских гласных i, ɪ и e, произнесенные нанайским носителем мужского пола из селения Джуен. Каждая строчка — отдельное произнесение. Переменные:</p>
<ul>
<li>f1 — первая форманта</li>
<li>f2 — вторая форманта</li>
</ul>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb224-1" aria-hidden="true" tabindex="-1"></a>nanai <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/agricolamz/2021_da4l/master/data/nanai_vowels.csv&quot;</span>)</span>
<span id="cb224-2"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb224-2" aria-hidden="true" tabindex="-1"></a>nanai <span class="sc">%&gt;%</span> </span>
<span id="cb224-3"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb224-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(f2, f1, <span class="at">label =</span> sound, <span class="at">color =</span> sound))<span class="sc">+</span></span>
<span id="cb224-4"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb224-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>()<span class="sc">+</span></span>
<span id="cb224-5"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb224-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rug</span>()<span class="sc">+</span></span>
<span id="cb224-6"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb224-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>()<span class="sc">+</span></span>
<span id="cb224-7"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb224-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_reverse</span>()<span class="sc">+</span></span>
<span id="cb224-8"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb224-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>()<span class="sc">+</span></span>
<span id="cb224-9"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb224-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb224-10"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb224-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb224-11"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb224-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Нанайские гласные в произнесении мужчины из селения Джуен&quot;</span>)</span></code></pre></div>
<p><img src="da4l_files/figure-html/unnamed-chunk-185-1.png" width="672" /></p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb225-1" aria-hidden="true" tabindex="-1"></a>mult <span class="ot">&lt;-</span> nnet<span class="sc">::</span><span class="fu">multinom</span>(sound<span class="sc">~</span>f1<span class="sc">+</span>f2, <span class="at">data =</span> nanai)</span></code></pre></div>
<pre><code># weights:  12 (6 variable)
initial  value 462.515774 
iter  10 value 51.522626
iter  20 value 46.817442
iter  30 value 44.829080
iter  40 value 44.807654
iter  40 value 44.807654
final  value 44.807654 
converged</code></pre>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb227-1" aria-hidden="true" tabindex="-1"></a>mult</span></code></pre></div>
<pre><code>Call:
nnet::multinom(formula = sound ~ f1 + f2, data = nanai)

Coefficients:
  (Intercept)          f1         f2
i   -22.85202 -0.04263175 0.02315226
ɪ   -41.46147  0.02360077 0.01937067

Residual Deviance: 89.61531 
AIC: 101.6153 </code></pre>
<p><span class="math display">\[\log(\frac{p(e)}{p(ɪ)}) = -41.46147 + 0.02360077\times f1 +0.01937067\times f2\]</span>
<span class="math display">\[\log(\frac{p(i)}{p(ɪ)}) = -22.85202 -0.04263175\times f1 +  0.02315226\times f2\]</span></p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb229-1" aria-hidden="true" tabindex="-1"></a>nanai <span class="sc">%&gt;%</span> </span>
<span id="cb229-2"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb229-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prediction =</span> <span class="fu">predict</span>(mult),</span>
<span id="cb229-3"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb229-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">correctness =</span> sound <span class="sc">==</span> prediction) <span class="sc">%&gt;%</span> </span>
<span id="cb229-4"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb229-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(f1, f2, <span class="at">label =</span> sound, <span class="at">color =</span> correctness))<span class="sc">+</span></span>
<span id="cb229-5"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb229-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">size =</span> <span class="sc">!</span>correctness), <span class="at">show.legend =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb229-6"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb229-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>()<span class="sc">+</span></span>
<span id="cb229-7"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb229-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_reverse</span>()<span class="sc">+</span></span>
<span id="cb229-8"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb229-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb229-9"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb229-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Нанайские гласные в произнесении мужчины из селения Джуен&quot;</span>,</span>
<span id="cb229-10"><a href="логистическая-порядковая-и-мультиномиальная-регрессия.html#cb229-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;мультиномиальная регрессия&quot;</span>)</span></code></pre></div>
<p><img src="da4l_files/figure-html/unnamed-chunk-187-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ограничения-на-применение-регрессии.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ссылки-на-литературу.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/agricolamz/2021_da4l/edit/master/09_logit_multinom.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["da4l.pdf"],
"toc": {
"collapse": "section"
},
"self_contained": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
